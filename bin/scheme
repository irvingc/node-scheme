#!/usr/bin/env node

var Readline = require('readline');
var Scheme = require('../lib/scheme');
var Util =  require('../lib/util');

var std = Readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

std.setPrompt('> ', 2);

std.on('line', function(cmd) {
  if(cmd == '\\q') {
    console.log("Exiting...");
    std.close();
  } else {

    Scheme.read(cmd, function(error, parsed) {

      if(error) {
        console.log(error.message);
      } else {

        var evaled = Scheme.eval(parsed);
        if(!Util.isError(evaled)) {
          console.log(Util.format(evaled));
        } else {
          console.log(error.message);
        }

      }

      std.prompt();
    
    });
  } 
});


std.prompt();
