#!/usr/bin/env node

var Readline = require('readline');
var Scheme = require('../lib/scheme');
var Util =  require('../lib/util');

var std = Readline.createInterface({
  input: process.stdin,
  output: process.stdout
});

std.setPrompt('> ', 2);

std.on('line', function(cmd) {
  if(cmd == '\\q') {
    console.log("Exiting...");
    std.close();
  } else {

    Scheme.read(cmd, function(error, parsed) {

      if(error) {
        console.log(error.message);
      } else {

        Scheme.eval(parsed, function(error, result) {

          if(error) {
            console.log(error.message);
          } else {
            console.log(Util.format(result));
          }

        });
      }

      std.prompt();
    
    });
  } 
});


std.prompt();
